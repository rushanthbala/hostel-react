{"ast":null,"code":"import axios from \"axios\";\nimport { GET_ERRORS, SET_CURRENT_STUDENT, LOGOUT } from \"./types\";\nimport setJWTToken from \"../securityUtils/setJWTToken\";\nimport jwt_decode from \"jwt-decode\";\nimport { Redirect } from 'react-router-dom';\nexport const createNewStudent = (newStudent, history) => async dispatch => {\n  try {\n    await axios.post(`http://localhost:8080/api/register`, newStudent);\n    history.push(\"/login\");\n    dispatch({\n      type: GET_ERRORS,\n      payload: {}\n    });\n  } catch (err) {\n    dispatch({\n      type: GET_ERRORS,\n      payload: err.response.data\n    });\n  }\n};\nexport const logout = () => async dispatch => {\n  localStorage.removeItem('logged');\n  localStorage.removeItem('jwtToken'); //dispatch({ type: LOGOUT }); \n};\nexport const login = (LoginRequest, history) => async dispatch => {\n  try {\n    const {\n      email,\n      password,\n      role1,\n      userId\n    } = LoginRequest;\n    const login = {\n      email,\n      password\n    };\n    console.log(login); // post => Login Request\n\n    const res = await axios.post(`http://localhost:8080/api/login`, login); // extract token from res.data\n\n    const {\n      token,\n      role\n    } = res.data; // store the token in the localStorage\n\n    localStorage.setItem(\"jwtToken\", token);\n    localStorage.setItem(\"logged\", true);\n    localStorage.setItem(\"role\", role);\n    localStorage.setItem(\"email\", email);\n    console.log(role); // set our token in header ***\n\n    setJWTToken(token); // decode token on React\n\n    const decoded = jwt_decode(token); // dispatch to our securityReducer\n\n    dispatch({\n      type: SET_CURRENT_STUDENT,\n      payload: decoded\n    });\n\n    if (role == \"student\") {\n      history.push(\"/studentDashboard\");\n    } else if (role == \"warden\") {\n      history.push(\"/wardenDashboard\");\n    } else if (role == \"admin\") {\n      history.push(\"/adminDashboard\");\n    } else {\n      history.push(\"/adminDashboard\");\n    }\n  } catch (err) {\n    dispatch({\n      type: GET_ERRORS,\n      payload: err.response.data\n    });\n  }\n};","map":{"version":3,"sources":["/home/venus/Downloads/hostel-react-master/src/actions/securityActions.js"],"names":["axios","GET_ERRORS","SET_CURRENT_STUDENT","LOGOUT","setJWTToken","jwt_decode","Redirect","createNewStudent","newStudent","history","dispatch","post","push","type","payload","err","response","data","logout","localStorage","removeItem","login","LoginRequest","email","password","role1","userId","console","log","res","token","role","setItem","decoded"],"mappings":"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","sourcesContent":["import axios from \"axios\";\nimport { GET_ERRORS,SET_CURRENT_STUDENT,LOGOUT} from \"./types\";\nimport setJWTToken from \"../securityUtils/setJWTToken\";\nimport jwt_decode from \"jwt-decode\";\nimport  { Redirect } from 'react-router-dom'\n\n\nexport const createNewStudent = (newStudent, history) => async dispatch => {\n  try {\n    await axios.post(`http://localhost:8080/api/register`, newStudent);\n    history.push(\"/login\");\n    dispatch({\n      type: GET_ERRORS,\n      payload: {}\n    });\n  } catch (err) {\n    dispatch({\n      type: GET_ERRORS,\n      payload: err.response.data\n    });\n  }\n};\n\nexport const logout = () => async dispatch => {\n  localStorage.removeItem('logged');\n  localStorage.removeItem('jwtToken');\n\n //dispatch({ type: LOGOUT }); \n \n}\n\n\nexport const login = (LoginRequest,history) => async dispatch => {\n  try {\n    const {email, password, role1, userId} = LoginRequest;\n    const login = {email,password};\n    console.log(login);\n    // post => Login Request\n      const res = await axios.post(`http://localhost:8080/api/login`, login);\n      // extract token from res.data\n      const { token,role } = res.data;\n      // store the token in the localStorage\n      localStorage.setItem(\"jwtToken\", token);\n      localStorage.setItem(\"logged\", true);\n      localStorage.setItem(\"role\",role);\n      localStorage.setItem(\"email\",email);\n      console.log(role);\n      // set our token in header ***\n      setJWTToken(token);\n      // decode token on React\n      const decoded = jwt_decode(token);\n      // dispatch to our securityReducer\n      dispatch({\n        type: SET_CURRENT_STUDENT,\n        payload: decoded\n      });\n   if(role==\"student\"){\n     history.push(\"/studentDashboard\");\n    }\n    else if(role==\"warden\"){\n      history.push(\"/wardenDashboard\");\n    }\n    else if(role==\"admin\"){\n      history.push(\"/adminDashboard\");\n    }\n    else{\n      history.push(\"/adminDashboard\");\n    }\n      \n    }\n    \n   catch (err) {\n    dispatch({\n      type: GET_ERRORS,\n      payload: err.response.data\n    });\n  }\n};\n"]},"metadata":{},"sourceType":"module"}